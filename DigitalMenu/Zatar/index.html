<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>منوی رستوران (موبایل)</title>

  <!-- فونت Vazir -->
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet" type="text/css" />
  <!-- Font Awesome (آیکون‌ها) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <style>
    :root {
      --primary: #0094DA; /* رنگ اصلی شما */
      --primary-600: #007bb5;
      --bg: #f7fafc;
      --card: #ffffff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --shadow: 0 8px 22px rgba(0,0,0,.08);
      --radius: 16px;
    }

    @font-face { font-family: 'ZFont'; src: url('z.ttf') format('truetype'); font-display: swap; }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; background: var(--bg); }
    body { margin: 0; font-family: Vazir, Tahoma, sans-serif; color: var(--text); overflow: hidden; }

    /* کانتینر موبایل */
    .app { height: 100%; display: grid; grid-template-rows: auto 1fr auto; }

    /* هدر فیکس و کم‌حجم */
    .topbar { position: sticky; top: 0; z-index: 10; display: flex; align-items: center; gap: 8px; padding: 10px 12px; background: var(--card); border-bottom: 1px solid var(--border); }
    .brand { display: flex; align-items: center; gap: 8px; color: var(--primary); font-weight: 700; font-size: 16px; }

    /* دسته‌ها: چیپ‌های افقی اسکرول‌دار */
    .cats { display: flex; gap: 8px; padding: 10px 12px; overflow-x: auto; background: var(--card); border-bottom: 1px solid var(--border); }
    .chip { flex: none; display: inline-flex; align-items: center; gap: 6px; padding: 8px 12px; border-radius: 999px; border: 1px solid var(--border); color: var(--muted); background: #fff; font-size: 13px; }
    .chip i { font-size: 13px; }
    .chip.active { color: #fff; background: linear-gradient(135deg, var(--primary), var(--primary-600)); border-color: transparent; box-shadow: 0 8px 18px rgba(0,148,218,.22); }

    /* لیست آیتم‌ها: شبکهٔ ۲ ستونه مخصوص موبایل */
    .list { overflow-y: auto; padding: 10px 10px 76px; }
    .title { position: sticky; top: 0; z-index: 5; padding: 10px; margin: 0 -10px 10px; background: linear-gradient(#ffffff, rgba(255,255,255,.8)); border-bottom: 1px solid var(--border); color: var(--primary); font-weight: 700; }

    .grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 10px; }
    @media (max-width: 360px) { .grid { grid-template-columns: 1fr; } }

    .card { position: relative; background: var(--card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; box-shadow: var(--shadow); }
    .img { width: 100%; height: 150px; background: #eef2f7; display: block; object-fit: cover; }

    /* اسکلت بارگذاری (شیمِر) */
    .skeleton { position: relative; background: #e9eef5; }
    .skeleton::after { content: ""; position: absolute; inset: 0; transform: translateX(-100%);
      background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,.55) 50%, rgba(255,255,255,0) 100%);
      animation: shimmer 1.1s infinite;
    }
    @keyframes shimmer { 100% { transform: translateX(100%); } }

    .box { padding: 10px; }
    .name { font-weight: 700; font-size: 13px; margin-bottom: 4px; }
    .desc { color: var(--muted); font-size: 11px; min-height: 32px; line-height: 1.6; }
    .price { margin-top: 8px; font-size: 13px; font-weight: 800; color: var(--primary-600); }
    .price-row { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
    .lbl { font-size: 10px; color: var(--muted); }

    /* فوتر کوچک */
    .footer { position: sticky; bottom: 0; background: var(--card); border-top: 1px solid var(--border); padding: 10px; text-align: center; font-size: 12px; color: var(--muted); }
    .footer a { color: var(--primary); text-decoration: none; }

    /* مودال تصویر ساده و سبک */
    .modal { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,.88); z-index: 40; }
    .modal.open { display: flex; }
    .modal img { max-width: 92vw; max-height: 80vh; border-radius: 12px; }
    .close { position: fixed; top: 10px; right: 12px; color: #fff; font-size: 28px; }

    /* احترام به کاهش حرکت */
    @media (prefers-reduced-motion: reduce) { .skeleton::after { display: none; } }
  </style>
</head>
<body>
  <div class="app">
    <!-- هدر موبایل -->
    <header class="topbar">
      <div class="brand"><i class="fa-solid fa-utensils"></i> <span>منوی رستوران</span></div>
    </header>

    <!-- دسته‌ها (اسکرول افقی) -->
    <nav class="cats" id="cats"></nav>

    <!-- لیست آیتم‌ها -->
    <main class="list" id="list">
      <div class="title" id="title">...</div>
      <section class="grid" id="grid"></section>
    </main>

    <!-- فوتر کوچک -->
    <footer class="footer">طراحی شده توسط تیم <a href="https://nirvanadev.ir" target="_blank" rel="noopener">نیروانا</a></footer>
  </div>

  <!-- مودال تصویر -->
  <div class="modal" id="imgModal" role="dialog" aria-modal="true">
    <span class="close" id="closeModal">&times;</span>
    <img id="modalImage" alt="" />
  </div>

  <script>
    // ===== داده‌ها (بدون تغییر محتوایی) =====
    const menuData = {
      "شاورما": [
        {name: "شاورما دجاج باگت", description: "ساندویچ شاورما مرغ با نان مخصوص", price: "185", image: "1.jpg"},
        {name: "شاورما دجاج عربی", description: "ساندویچ لقمه شده همراه سیب زمینی + سالاد + سس", price: "255", image: "A3.jpg"},
        {name: "شاورما دجاج صاج", description: "ساندویچ شاورما صاج با نون مخصوص", price: "255", image: "2.jpg"},
        {name: "مینی شاورما", description: "نصف ساندویچ شاورما با نان مخصوص", price: "100", image: "3.jpg"},
        {name: "پرس شاورما", description: "۲۵۰ گرم شاورما + سالاد + نان", price: "400", image: "4.jpg"}
      ],
      "فلافل": [
        {name: "ساندویچ فلافل", description: "ساندویچ فلافل 5 عددی با نان مخصوص و سبزیجات تازه", price: "100", image: "5.jpg"},
        {name: "ساندویچ فلافل مُشَکَل", description: "ساندویچ فلافل همراه سیب زمینی + بادمجان", price: "120", image: "6.jpg"},
        {name: "ساندویچ فلافل مخصوص زعتر", description: "نان صاج همراه فلافل + حمص", price: "110", image: "7.jpg"},
        {name: "فلافل تکی", description: "", price: "15", image: "A1.jpg"},
        {name: "ساندویچ هات داگ", description: "هات داگ با نان مخصوص و سس های ویژه", price: "120", image: "8.jpg"},
        {name: "همبرگر", description: "همبرگر دست ساز", price: "280", image: "A2.WEBP"}
      ],
      "معجنات": [
        {name: "مینی صفیحه", description: "گوشت، گوجه، پیاز چرخ کرده، ادویه مخصوص", price: "88", image: "9.jpg"},
        {name: "مینی دجاج بالعجین", description: "مرغ شاورما، پنیر، قارچ، ذرت، زیتون", price: "88", image: "10.jpg"},
        {name: "مینی پیتزا دجاج", description: "مرغ شاورما، پنیر، قارچ، ذرت، زیتون", price: "98", image: "25.jpg"},
        {name: "مینی زعتر", description: "آویشن لبنانی، روغن زیتون، کنجد", price: "88", image: "12.jpg"},
        {name: "مینی زعتر قشقوان", description: "آویشن لبنانی، روغن زیتون، پنیر پیتزا", price: "88", image: "13.jpg"},
        {name: "مینی محمره قشقوان", description: "سس مخصوص تند، پنیر، کنجد، سیاه دانه", price: "88", image: "14.jpg"},
        {name: "مینی کبابه", description: "گوشت کبابی، ادویه مخصوص زعتر", price: "88", image: "15.jpg"},
        {name: "مینی جنبه زیتون", description: "پنیر، زیتون، ادویه مخصوص زعتر", price: "88", image: "16.jpg"},
        {name: "مینی جبن بالعجین", description: "پنیر پیتزا، ادویه مخصوص زعتر", price: "88", image: "17.jpg"},
        {name: "مینی پپرونی", description: "پپرونی با پنیر و سس مخصوص", price: "98", image: "18.jpg"}
      ],
      "صحون\n(بشقاب ها)": [
        {name: "کبه برنج", description: "کبۀ مخصوص با برنج عربی و ادویه‌های ویژه", price: "88", image: "19.jpg"},
        {name: "سیب زمینی", description: "سیب زمینی سرخ شده با ادویه مخصوص", price: "120", image: "20.jpg"},
        {name: "سیب زمینی مخصوص زعتر", description: "سیب زمینی با ادویه مخصوص و مرغ شاورما", price: "220", image: "21.jpg"},
        {name: "سمبوسه پیتزایی", description: "سمبوسه مواد پیتزا و پنیر پیتزا و ادویه مخصوص", price: "78", image: "22.jpg"},
        {name: "سمبوسه ساده", description: "سمبوسه با سیب زمینی و سبزیجات", price: "68", image: "22.jpg"}
      ],
      "پیتزا لبنانی": [
        {name: "پیتزا بعلبکی", description: "پیتزا مخصوص سرآشپز - مرغ شاورما، مواد پیتزا، خمیر مخصوص دو طرفه", priceSingle: "248", priceDouble: "448", image: "24.jpg"},
        {name: "پیتزا دجاج", description: "مرغ شاورما با پنیر و سس مخصوص", priceSingle: "228", priceDouble: "428", image: "25.jpg"},
        {name: "پیتزا پپرونی", description: "پپرونی با پنیر و سس مخصوص", priceSingle: "198", priceDouble: "298", image: "18.jpg"}
      ],
      "مقبلات (سالاد)": [
        {name: "تبوله", description: "جعفری، گوجه بلغور گندم، سس مخصوص زعتر", price: "100", image: "27.jpg"},
        {name: "حمص بطحینه", description: "ارده، نخود، روغن زیتون", price: "100", image: "28.jpg"},
        {name: "متبل", description: "ماست، ارده، بادمجان ذغالی", price: "100", image: "29.jpg"},
        {name: "بذنجانیه", description: "بادمجان سرخ شده، خیار، گوجه، فلفل دلمه، پیاز، سس مخصوص", price: "100", image: "30.JPG"},
        {name: "فته بذنجان", description: "بادمجان سرخ شده، ماست، ارده", price: "100", image: "31.jpg"},
        {name: "صحن مقبلات مُشکل", description: "۴نوع سینی مزه به دلخواه", price: "400", image: "32.JPG"}
      ],
      "باکس ها": [
        {name: "باکس ۲ نفره", description: "۲ عدد شاورما عربی + ۲ مدل سالاد + سس + نوشابه", price: "620", image: "33.jpg"},
        {name: "باکس ۲ نفره مُشکل", description: "۱ عدد شاورما عربی + ۱ عدد ساندویچ فلافل + ۲ مدل سالاد + سس + نوشابه", price: "520", image: "33.jpg"},
        {name: "باکس خانواده", description: "۵ عدد شاورما عربی + ۴ مدل سالاد + سس + نوشابه", price: "1,510", image: "35.jpg"},
        {name: "باکس معجنات", description: "9 عدد مینی معجنات به دلخواه", price: "765", image: "36.jpg"}
      ]
    };

    // ===== ابزارها =====
    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => r.querySelectorAll(s);
    const faDigits = n => n.toLocaleString('fa-IR');
    const parseNum = s => parseInt(String(s).replace(/[^\d]/g, ''), 10);
    const formatPrice = s => {
      const num = parseNum(s);
      return isNaN(num) ? s : `${faDigits(num)} تومان`;
    };

    const iconFor = (cat) => {
      if (cat.includes('پیتزا')) return 'fa-pizza-slice';
      if (cat.includes('شاورما')) return 'fa-drumstick-bite';
      if (cat.includes('فلافل')) return 'fa-burger';
      if (cat.includes('مقبلات') || cat.includes('سالاد')) return 'fa-bowl-food';
      if (cat.includes('باکس')) return 'fa-box-open';
      return 'fa-utensils';
    };

    // ===== DOM =====
    const cats = $('#cats');
    const grid = $('#grid');
    const title = $('#title');

    const imgModal = $('#imgModal');
    const modalImage = $('#modalImage');
    $('#closeModal').addEventListener('click', () => imgModal.classList.remove('open'));
    imgModal.addEventListener('click', () => imgModal.classList.remove('open'));

    // ساخت چیپ‌های دسته‌ها
    const categories = Object.keys(menuData);
    categories.forEach((cat, i) => {
      const b = document.createElement('button');
      b.className = 'chip' + (i===0 ? ' active' : '');
      b.innerHTML = `<i class="fa-solid ${iconFor(cat)}"></i><span>${cat.replace('\n',' ')}</span>`;
      b.addEventListener('click', () => selectCategory(cat, b));
      cats.appendChild(b);
    });

    // انتخاب دسته و رندر آیتم‌ها (با رندر تدریجی + Lazy)
    let currentCategory = categories[0];
    selectCategory(currentCategory, cats.firstElementChild);

    function selectCategory(cat, el) {
      currentCategory = cat;
      $$('.chip').forEach(c => c.classList.remove('active'));
      el.classList.add('active');
      title.textContent = cat === 'پیتزا لبنانی' ? 'پیتزا لبنانی (تک نفره و دو نفره)' : cat;
      renderItems();
      // اسکرول بالا
      $('#list').scrollTo({ top: 0, behavior: 'smooth' });
    }

    // رندر در دسته‌های کوچک برای کاهش درخواست‌ها
    const BATCH = 6; // هر بار چند کارت بسازیم
    let batchIndex = 0; // برای ناوبری بین دسته‌ها

    function renderItems() {
      grid.innerHTML = '';
      batchIndex = 0;
      const items = menuData[currentCategory];
      appendBatch(items);

      // sentinel برای بارگذاری بیشتر هنگام نزدیک شدن به انتهای صفحه
      const sentinel = document.createElement('div');
      sentinel.style.height = '1px';
      grid.appendChild(sentinel);

      const ioMore = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
          appendBatch(items);
          if ((batchIndex * BATCH) >= items.length) ioMore.disconnect();
        }
      }, { root: $('#list'), rootMargin: '200px' });
      ioMore.observe(sentinel);
    }

    function appendBatch(items) {
      const start = batchIndex * BATCH;
      const end = Math.min(start + BATCH, items.length);
      for (let i = start; i < end; i++) createCard(items[i]);
      batchIndex++;
    }

    // Lazy Image با IntersectionObserver + Placeholder سبک
    const ioImg = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          const real = img.getAttribute('data-src');
          img.src = real;
          img.onload = () => img.classList.remove('skeleton');
          ioImg.unobserve(img);
        }
      });
    }, { root: $('#list'), rootMargin: '300px' });

    function createCard(item) {
      const card = document.createElement('article');
      card.className = 'card';

      const img = document.createElement('img');
      img.className = 'img skeleton';
      img.alt = item.name;
      // Placeholder SVG فوق‌العاده سبک تا وقتی تصویر اصلی لود شود
      img.src = 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="8" height="5" viewBox="0 0 8 5"><rect width="8" height="5" fill="%23e9eef5"/></svg>';
      img.setAttribute('data-src', item.image);
      img.setAttribute('loading', 'lazy');
      img.setAttribute('decoding', 'async');
      img.setAttribute('fetchpriority', 'low');
      img.referrerPolicy = 'no-referrer';

      img.onerror = () => { img.classList.remove('skeleton'); img.src = 'logo.png'; img.style.objectFit = 'contain'; };
      img.addEventListener('click', (e) => {
        e.stopPropagation();
        modalImage.src = img.getAttribute('data-src') || img.src;
        modalImage.alt = item.name;
        imgModal.classList.add('open');
      });

      ioImg.observe(img);

      const box = document.createElement('div');
      box.className = 'box';

      const name = document.createElement('div');
      name.className = 'name';
      name.textContent = item.name;

      const desc = document.createElement('div');
      desc.className = 'desc';
      desc.textContent = item.description || '';

      const price = document.createElement('div');

      if (currentCategory === 'پیتزا لبنانی') {
        const row = document.createElement('div');
        row.className = 'price-row';
        row.innerHTML = `
          <div><div class="lbl">تک نفره</div><div class="price">${formatPrice(item.priceSingle)}</div></div>
          <div><div class="lbl">دو نفره</div><div class="price">${formatPrice(item.priceDouble)}</div></div>
        `;
        price.appendChild(row);
      } else {
        price.className = 'price';
        price.textContent = item.price ? formatPrice(item.price) : '';
      }

      const boxFrag = document.createDocumentFragment();
      boxFrag.appendChild(name);
      boxFrag.appendChild(desc);
      boxFrag.appendChild(price);

      box.appendChild(boxFrag);

      card.appendChild(img);
      card.appendChild(box);

      grid.appendChild(card);
    }
  </script>
</body>
</html>
